<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripting (Basics)</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h3>Scripting (Basics)</h3>
    <br>

        <div id="ssl"><h4>SSL - Star Trek scripting language</h4></div>
            <p> No, you have not misread, the scripting language used to script Fallout 2 is called Star Trek scripting language or in short SSL. 
                SSL is a mix of pascal or lua with C. Only the devs know what this abomination is.
                Black Isle Studios created SSL for their Star Trek game that never came true. When they made Fallout 1 and 2 they simply used SSL to script them.
                Some refer to it as Fallout scripting language, some as Star Trek scripting language and some just call it SSL but all mean the same.
                If you want to know more you can ask the community, they should know more about it.</p>
         <br>

        <div id="script"><h4>Script</h4></div>
            <p> A script is just a file that contains the source code of the Fallout scripting language. 
                Any object in the game can have a script. 
                Scripts are needed to assign a certain behavior to an object (critter, scenery, items etc.), 
                so that it can be interacted with. They breathe life into the game world and its inhabitants.
                Not only the player can interact with scripts,
                but even scripts can interact with eachother. 
                You could also build a map and place critters, scenery and stuff without assigning scripts to them.
                You could nevertheless interact with them but not that much.
                What does it mean "not that much"?
                Well, the game uses default scripts if you don't assign any like combat, push, look, description etc.</p>
        
            <p> Let’s see how a script can look like. The following is the script for the well found in Arroyo village.</p>   
                <code>
                    <pre>
                        <span class="dyeheader">/* Include Files */</span> 
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\define.h"</span>
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\arvillag.h"</span>
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\command.h"</span>
                        
                        <span class="dyedefine">#define</span> NAME                    SCRIPT_ASWELL
                        
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">start</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">use_skill_on_p_proc</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">description_p_proc</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">look_at_p_proc</span>;
                        
                        <span class="dyedefine">#define</span> LVAR_Gave_Xp            (<span class="dyedefine">0</span>)
                        
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">start</span> <span class="dyestatement">begin</span>
                        <span class="dyestatement">end</span>
                        
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">description_p_proc</span> <span class="dyestatement">begin</span>
                            <span class="dyefunction">script_overrides</span>;                                     
                            <span class="dyestatement">if</span> (<span class="dyefunction">map_var</span>(MVAR_Fixed_Well) <span class="dyeoperator">==</span> <span class="dyedefine">0</span>) <span class="dyestatement">then</span> <span class="dyestatement">begin</span>         
                                <span class="dyefunction">display_msg</span>(<span class="dyestandardmacro">mstr</span>(<span class="dyedefine">100</span>));                           
                            <span class="dyestatement">end</span>
                            <span class="dyestatement">else</span> <span class="dyestatement">begin</span> 
                                <span class="dyefunction">display_msg</span>(<span class="dyestandardmacro">mstr</span>(<span class="dyedefine">101</span>));                           
                            <span class="dyestatement">end</span>
                        <span class="dyestatement">end</span>
                        
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">look_at_p_proc</span> <span class="dyestatement">begin</span> 
                            <span class="dyefunction">script_overrides</span>;
                            <span class="dyestatement">if</span> (<span class="dyefunction">map_var</span>(MVAR_Fixed_Well) <span class="dyeoperator">==</span> <span class="dyedefine">0</span>) then <span class="dyestatement">begin</span> 
                                <span class="dyefunction">display_msg</span>(<span class="dyestandardmacro">mstr</span>(<span class="dyedefine">100</span>));
                            <span class="dyestatement">end</span>
                            <span class="dyestatement">else</span> <span class="dyestatement">begin</span> 
                                <span class="dyefunction">display_msg</span>(<span class="dyestandardmacro">mstr</span>(<span class="dyedefine">101</span>));
                            <span class="dyestatement">end</span>
                        <span class="dyestatement">end</span>
                        
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">use_skill_on_p_proc</span> <span class="dyestatement">begin</span> 
                            <span class="dyestatement">if</span> ((<span class="dyefunction">action_being_used</span> <span class="dyeoperator">==</span> <span class="dyehardcoded">SKILL_REPAIR</span>) <span class="dyestatement">and</span> (<span class="dyefunction">local_var</span>(LVAR_Gave_Xp) == <span class="dyedefine">0</span>)) <span class="dyestatement">then</span> <span class="dyestatement">begin</span>        
                                <span class="dyefunction">script_overrides</span>;
                                <span class="dyefunction">display_msg</span>(<span class="dyefunction">message_str</span>(SCRIPT_GENERIC,<span class="dyedefine">1005</span>));                                           
                                <span class="dyedevelopermacro">give_xp</span>(EXP_FIX_WELL);                                                                   
                                <span class="dyefunction">set_map_var</span>(MVAR_Fixed_Well,<span class="dyedefine">1</span>);                                                          
                                <span class="dyefunction">set_local_var</span>(LVAR_Gave_Xp,<span class="dyedefine">1</span>);                                                           
                            <span class="dyestatement">end</span>
                        <span class="dyestatement">end</span>
                    </pre>
                </code>
            <p> At first glance it can look overwelming even intimidating. But fear not! We will go through this step by step. First of all we will look at the structure. We'll go more indepth later.</p>
        <br>

        <div id="header"><h4>Header File</h4></div>
            <p> Header files are files that store information that is used repeatedly in every script. 
                So, you don’t have to rewrite the same code over and over again in every script. 
                Once written inside a header File and just included at the top of a script where you want to use the code and you’re good to go.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\define.h"</span>
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\arvillag.h"</span>
                        <span class="dyedefine">#include</span> <span class="dyeheader">"..\headers\command.h"</span>
                    </pre>
                </code>
            <p> As you can see the suffix of header files is .h.</p>
            <p> They are located inside the folder "\HEADERS".</p>
        <br>

        <div id="define"><h4>Define</h4></div>
            <p> With #define it is possible to specify strings that will be exchanged for another string before the program is translated. 
                Again, the # character causes the preprocessor to do its work first before the nascent program is translated by the compiler into machine language.</p>
            <p> We have two #defines in this example.</p> 
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> NAME &emsp; &emsp; SCRIPT_ASWELL
                    </pre>
                </code>
            <p> and</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> LVAR_Gave_Xp            (<span class="dyedefine">0</span>)
                    </pre>
                </code>
            <p> In the #define below NAME is SCRIPT_ASWELL. This means if you want to refer to SCRIPT_ASWELL inside your script you simply can write NAME.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> NAME &emsp; &emsp; SCRIPT_ASWELL
                    </pre>
                </code>
            <p> If you hover over SCRIPT_ASWELL with your cursor you'll see the description inside the bluegreyish box.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> NAME &emsp; &emsp; SCRIPT_ASWELL
                        <div class="codepopup" >
                            <div class="codepre">
                                Define: SCRIPT_ASWELL
                                (217) //ASWell.int  :Arroyo Well. It's broken. Fix w/ Repair.
                                
                                Declare file: scripts.h
                            </div>
                        </div>
                    </pre>
                </code>
            <p>The file SCRIPTS.H is located inside HEADERS\SCRIPTS.H. We'll talk about this later.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> SCRIPT_ASWELL &emsp; &emsp; (<span class="dyedefine">217</span>) &emsp; <span class="dyecomment">// ASwell.int</span> &emsp; &emsp; <span class="dyecomment">; Arroyo Well. It's broken. Fix w/ Repair.</span>
                    </pre>
                </code>
        <br>

        <div id="procedure"><h4>Procedure</h4></div>
            <p> Procedures are just like small programs inside your script. They are an essential part of the program and help programmers to keep the script clear, organized, structured and avoid repetitions since they promote code re-use. 
                A procedure in Fallout scripting language starts with <span class="dyestatement">procedure </span> a name (<span class="dyeprocedure">start</span> in this case) <span class="dyestatement">begin</span>  
                and ends with an <span class="dyestatement">end</span> statement.</p>
            <p> We have four procedures in this example. start; use_skill_on_p_proc; description_p_proc and look_at_p_proc. There are more but this scripts just uses these four. They are predefinied by the devs but you can also write your own procecures.</p>
                Every procedure you use inside your script needs to be declared at the top of the script like seen below.
                <!-- The part below doesn't fit into here.-->
                <!--It can also have its own variables called local variables. 
                Local variables belonging to procedures cannot be used with the main-program. 
                Variables declared in a program are called global variables.-->
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">start</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">use_skill_on_p_proc</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">description_p_proc</span>;
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">look_at_p_proc</span>;
                    </pre>
                </code>  
            <p> The space between <span class="dyestatement">begin</span> and <span class="dyestatement">end</span> is called procedure body. Inside the body you write the stuff you want to be executed.
                In the example below the body is empty. An empty procedure body cannot execute anything because there is nothing to execute. 
                If you call an empty procedure, the procedure starts, sees there's nothing inside the body and ends immediately.</p>
            <p> The most important procedure of them all is the procedure called "start". The start procedure is the entry point of scripts.
                Every script has it and every script needs it. If you don't have the start procedure inside you script, it won't work.</p>
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">start</span> <span class="dyestatement">begin</span>
                        <span class="dyestatement">end</span>
                    </pre>
                </code>
            <p> The other three procedures inside the example script are these.</p>
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">description_p_proc</span> <span class="dyestatement">begin</span>
                        [...]
                        <span class="dyestatement">end</span>
                    </pre>
                </code>
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">look_at_p_proc</span> <span class="dyestatement">begin</span> 
                        [...]
                        <span class="dyestatement">end</span>
                    </pre>
                </code>
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">use_skill_on_p_proc</span> <span class="dyestatement">begin</span> 
                        [...]
                        <span class="dyestatement">end</span>
                    </pre>
                </code>
                <p> You can call procedures from every corner of your script like this.</p>
                <code>
                    <pre>
                        <span class="dyestatement">call</span> <span class="dyeprocedure">use_skill_on_p_proc</span>;
                    </pre>
                </code>
        <br>

        <div id="function"><h4>Function</h4></div>
            <p> Simple hardcoded commands of SSL are called functions. The stuff you write inside the procedure body. That means they are basis commands, and cannot be broken down further.</p>
            <p> A simple function can look like this:</p>
                <code>
                    <pre>
                        <span class="dyefunction">display_msg</span>
                    </pre>
                </code>
            <p> You can also write something more complex like this:</p>
                <code>
                    <pre>
                        <span class="dyefunction">display_msg</span>(<span class="dyefunction">message_str</span>(SCRIPT_GENERIC,<span class="dyedefine">1005</span>));
                    </pre>
                </code>
            <p> As you can see there is a function inside a function and some other stuff. That's also possible.</p>
        <br>

        <div id="argument/parameter"><h4>Argument</h4></div>
            <p>The stuff inside the parenthesis is called argument.</p>
                <code>
                    <pre>
                        <span class="dyefunction">display_msg</span>(<span class="dyefunction">message_str</span>(SCRIPT_GENERIC,<span class="dyedefine">1005</span>));
                    </pre>
                </code>
                <p> An argument is also passed here.</p>
                <code>
                    <pre>
                        <span class="dyedevelopermacro">give_xp</span>(EXP_FIX_WELL); 
                    </pre>
                </code>
            <p>Many functions need to pass something and what they pass is called an argument.</p>
        <!--<p> This give_xp(x) gives a certain amount of experience points to the player and displays a message to the player so he is informed how many exp points he received. 
                The amount of the exp points given is defined with the symbol between the brackets, in this example (x). This is called an argument or parameter.</p>-->
        <br>

        <div id="variable"><h4>Variable</h4></div>
            <p>A variable is like a temporary container. You can save things into it. For example strings, integers, booleans and the result of functions etc.</p>
            <p>There are several types of variables. The ones which get into global namespace and the ones that don't. The global namespace is the place where variables are shared between scripts.
                So every variable inside the global namespace needs to have a unique name otherwise the engine gets confused and throws errors. 
                This also means variables that are inside the global namespace are saved and remembered on map change or game load. 
                The other variables that are not inside the global namespace just run while the script they are defined in is running. They will be forgotten on map change or game load. </p>
        <br>
            <p>Let's take a look at the different types of variables.</p>
            <p>Variables getting into global namespace are:</p>
            <p>LVAR; MVAR and GVAR.</p>            
        <br>
            <p>This variable is of type Local variable (LVAR). It is saved during map change. LVARs are used for circumstances that aren't that significant e.g. have experience points been given to the player?
                All LVARs will be prepended with LVAR_.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> LVAR_Gave_Xp; &emsp; &emsp; (<span class="dyedefine">0</span>)
                    </pre>
                </code>
            <p>This variable is of type Map variable (MVAR). It is saved during map change. MVARs are stored in the corresponding map script. 
                In this case MVAR_Fixed_Well is stored inside arvillag.H. With the include command the MVAR can be used in the script. 
                Map variables need to be added to a file called mapName.gam which must be put in the data\maps directory.
                MVARs are used for circumstances that are significant for a specific map like has the well been fixed?
                All MVARs will be prepended with MVAR_.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> MVAR_Fixed_Well; &emsp; &emsp; (<span class="dyedefine">4</span>)
                    </pre>
                </code>
            <p>This variable is of type Global variable. It can be used in any script. To use this type of variable, only the file global.H must be included into the script. 
                It is saved during the map change. Any global variables you #define and use must also be put into a file called VAULT13.gam which is found inside the data\data directory. 
                GVARs will be stored in a header file called Global.h, located in the \Fallout2\Scripts\Headers\ directory. 
                All GVARs will be prepended with GVAR_.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> GVAR_DUMAR_STATUS; &emsp; &emsp; (<span class="dyedefine">369</span>)
                    </pre>
                </code>
            <p>The number inside the parenthesis of all three global namespace variables is no value. It serves as a placeholder for the engine. As soon as the script is executed, 
                the engine replaces the names of the global namespace variables with the number assigned to it.</p>
            <p>These three variable types must always be defined at the top of the script like in the sample script.</p>
        <br>
            <p>Variables not getting into global namespace are:</p>
            <p>variable and export/import variable.</p>
        <br>
            <p> The variable Only_Once is defined outside the procedure and assigned the value <span class="dyedefine">0</span>. 
                This variable can be used in every procedure inside the script. This variable will not be saved when changing the map.</p>
                <code>
                    <pre>
                        <span class="dyestatement">variable</span> Only_Once <span class="dyeoperator">:=</span> <span class="dyedefine">0</span>;

                        <span class="dyestatement">procedure</span> <span class="dyeprocedure">map_enter_p_proc</span> <span class="dyestatement">begin</span>
                            Only_Once <span class="dyeoperator">:=</span> <span class="dyedefine">0</span>;
                    </pre>
                </code>
            <p>The variable item is defined inside the procedure <span class="dyeprocedure">combat_p_proc</span>.
                This variable can only be used inside the procedure. This variable will not be saved when changing the map.</p>
                <code>
                    <pre>
                        <span class="dyestatement">procedure</span><span class="dyeprocedure"> combat_p_proc</span> <span class="dyestatement">begin</span>
                            <span class="dyestatement">variable</span> item;

                                item <span class="dyeoperator">:=</span> <span class="dyestandardmacro">create_object</span>(PID_HEALING_POWDER),<span class="dyedefine">0</span>,<span class="dyedefine">0</span>);
                                <span class="dyefunction">use_obj_on_obj</span>(item,<span class="dyefunction">self_obj</span>);
                    </pre>
                </code>
            <p>This variable is defined inside script ARCAVES.SSL. The keyword export ensures that the variable can be used in other scripts. 
                The variable contains the last value that was assigned to it.</p>
                <code>
                    <pre>
                        <span class="dyestatement">export variable</span> temple_chest_prt;
                    </pre>
                </code>
            <p>The previously exported variable can now be used with the keyword import inside the scripts AITEMCST.SSL and ACTEMVIL.SSL. 
                The variable contains the value that was last assigned to it.</p>
                <code>
                    <pre>
                        <span class="dyestatement">import variable</span> temple_chest_prt;
                    </pre>
                </code>
        <br>

        <div id="constant"><h4>Constant</h4></div>
            <p>Constants are variables with one-time fixed unchangeable value. A good example is give_xp(EXP_FIX_WELL) because EXP_FIX_WELL is a constant which is defined in ExpPoint.H. 
                If you use EXP_FIX_WELL in several scripts and you want to change the given experience from 100 to 200 you just need to change the value in on place, in ExpPoint.H.</p>
                <code>
                    <pre>
                        <span class="dyedefine">#define</span> EXP_FIX_WELL; &emsp; &emsp; (<span class="dyedefine">100</span>)
                    </pre>
                </code>
        <br>
        
        <div id="macro"><h4>Macro</h4></div>
            <p>A macro is a collection of functions. Functions can easily get huge and messy.</p>
            <p>Let's look at an example.</p>
                <code>
                    <pre>
                        <span class="dyedevelopermacro">give_xp</span>(EXP_FIX_WELL); 
                    </pre>
                </code>
            <p>The macro give_xp(x) is located inside the file EXPPOINT.H.</p>
            <p>Behind give_xp(x) actually hides:</p>  
                <code>
                    <pre>
                       <span class="dyefunction">give_exp_points</span>(x);
                       <span class="dyefunction">display_msg</span>(<span class="dyefunction">message_str</span>(SCRIPT_GENERIC,<span class="dyedefine">100</span>)<span class="dyeoperator">+</span>x<span class="dyeoperator">+</span><span class="dyefunction">message_str</span>(SCRIPT_GENERIC,<span class="dyedefine">101</span>))
                    </pre>
                </code>
        <br>

        <div id="operator"><h4>Operator</h4></div>
            <p><span class="dyeoperator">:=</span> (assign value - Assigns the value on the right side to the value on the left side.)</p>
            <p><span class="dyeoperator">></span> (greater than - Checks if the value on the left side is greater then the value on the right side.)</p>
            <p><span class="dyeoperator"><</span> (lesser than - Checks if the value on the left side is lesser then the value on the right side.)</p>
            <p><span class="dyeoperator">>=</span> (greater than or equal to - Checks if the value on the left side is greater then or equal to the value on the right side.)</p>
            <p><span class="dyeoperator"><=</span> (lesser than or equal to - Checks if the value on the left side is lesser then or equal to the value on the right side.)</p>
            <p><span class="dyeoperator">==</span> (equals - Checks if the value on the left side is exactly the same as the value on the right side.)</p>
            <p><span class="dyeoperator">!=</span> (does not equal - Checks if the value on the left side is not exactly the same as the value on the right side.)</p>
        <br>

        <div id="statement"><h4>Statement</h4></div>
            <p>if then else is a Statement.</p>
        <br>

        <div id="semicolon"><h4>Semicolon</h4></div>
        <br>

    <div class="sticky">
        <a href="prep.html">&laquo; Previous</a>
        <br>
            <img class="sticky" src="images\Radioactive_symbol.png">	
        <br>
        <a href="index.html">Index</a>
        <br>
            <img class="sticky" src="images\Radioactive_symbol.png">	
        <br>
        <a href="complex.html">Next &raquo;</a>
    </div>

    <!--<footer>
        <div class="symbol">
            <a href="prep.html">&laquo; Previous</a>
                <img src="images\Radioactive_symbol.png">	
            <a href="index.html">Index</a>
                <img src="images\Radioactive_symbol.png">
            <a href="complex.html">Next &raquo;</a>	
        </div>
    </footer>-->
</body>
</html>